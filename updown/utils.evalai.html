
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" />

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-120523111-2"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-120523111-2');
    </script>

    <link href="https://fonts.googleapis.com/css?family=Inconsolata&display=swap" rel="stylesheet">


    <title>updown.utils.evalai &#8212; updown 1.0.0 documentation</title>

    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="updown.utils.common" href="utils.common.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-updown.utils.evalai">
<span id="updown-utils-evalai"></span><h1>updown.utils.evalai<a class="headerlink" href="#module-updown.utils.evalai" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="updown.utils.evalai.NocapsEvaluator">
<em class="property">class </em><code class="sig-prename descclassname">updown.utils.evalai.</code><code class="sig-name descname">NocapsEvaluator</code><span class="sig-paren">(</span><em class="sig-param">phase: str = 'val'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/nocaps-org/updown-baseline/blob/master/updown/utils/evalai.py#L12-L148"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#updown.utils.evalai.NocapsEvaluator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A utility class to submit model predictions on nocaps splits to EvalAI, and retrieve model
performance based on captioning metrics (such as CIDEr, SPICE).</p>
<p>This class and the training script together serve as a working example for “EvalAI in the
loop”, showing how evaluation can be done remotely on privately held splits. Annotations
(captions) and evaluation-specific tools (e.g. <a class="reference external" href="https://www.github.com/tylin/coco-caption">coco-caption</a>)
are not required locally. This enables users to select best checkpoint, perform early
stopping, learning rate scheduling based on a metric, etc. without actually doing evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>phase: str, optional (default = “val”)</strong></dt><dd><p>Which phase to evaluate on. One of “val” or “test”.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This class can be used for retrieving metrics on both, val and test splits. However, we
recommend to avoid using it for test split (at least during training). Number of allowed
submissions to test split on EvalAI are very less, and can exhaust in a few iterations! However,
the number of submissions to val split are practically infinite.</p>
<dl class="method">
<dt id="updown.utils.evalai.NocapsEvaluator.evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param">self, predictions:List[updown.types.Prediction], iteration:Union[int, NoneType]=None</em><span class="sig-paren">)</span> &#x2192; Dict[str, Dict[str, float]]<a class="reference external" href="https://github.com/nocaps-org/updown-baseline/blob/master/updown/utils/evalai.py#L44-L148"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#updown.utils.evalai.NocapsEvaluator.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Take the model predictions (in COCO format), submit them to EvalAI, and retrieve model
performance based on captioning metrics.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>predictions: List[Prediction]</strong></dt><dd><p>Model predictions in COCO format. They are a list of dicts with keys
<code class="docutils literal notranslate"><span class="pre">{&quot;image_id&quot;:</span> <span class="pre">int,</span> <span class="pre">&quot;caption&quot;:</span> <span class="pre">str}</span></code>.</p>
</dd>
<dt><strong>iteration: int, optional (default = None)</strong></dt><dd><p>Training iteration where the checkpoint was evaluated.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt>Dict[str, Dict[str, float]]</dt><dd><p>Model performance based on all captioning metrics. Nested dict structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;B1&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;in-domain&quot;</span><span class="p">,</span> <span class="s2">&quot;near-domain&quot;</span><span class="p">,</span> <span class="s2">&quot;out-domain&quot;</span><span class="p">,</span> <span class="s2">&quot;entire&quot;</span><span class="p">},</span>  <span class="c1"># BLEU-1</span>
    <span class="s2">&quot;B2&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;in-domain&quot;</span><span class="p">,</span> <span class="s2">&quot;near-domain&quot;</span><span class="p">,</span> <span class="s2">&quot;out-domain&quot;</span><span class="p">,</span> <span class="s2">&quot;entire&quot;</span><span class="p">},</span>  <span class="c1"># BLEU-2</span>
    <span class="s2">&quot;B3&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;in-domain&quot;</span><span class="p">,</span> <span class="s2">&quot;near-domain&quot;</span><span class="p">,</span> <span class="s2">&quot;out-domain&quot;</span><span class="p">,</span> <span class="s2">&quot;entire&quot;</span><span class="p">},</span>  <span class="c1"># BLEU-3</span>
    <span class="s2">&quot;B4&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;in-domain&quot;</span><span class="p">,</span> <span class="s2">&quot;near-domain&quot;</span><span class="p">,</span> <span class="s2">&quot;out-domain&quot;</span><span class="p">,</span> <span class="s2">&quot;entire&quot;</span><span class="p">},</span>  <span class="c1"># BLEU-4</span>
    <span class="s2">&quot;METEOR&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;in-domain&quot;</span><span class="p">,</span> <span class="s2">&quot;near-domain&quot;</span><span class="p">,</span> <span class="s2">&quot;out-domain&quot;</span><span class="p">,</span> <span class="s2">&quot;entire&quot;</span><span class="p">},</span>
    <span class="s2">&quot;ROUGE-L&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;in-domain&quot;</span><span class="p">,</span> <span class="s2">&quot;near-domain&quot;</span><span class="p">,</span> <span class="s2">&quot;out-domain&quot;</span><span class="p">,</span> <span class="s2">&quot;entire&quot;</span><span class="p">},</span>
    <span class="s2">&quot;CIDEr&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;in-domain&quot;</span><span class="p">,</span> <span class="s2">&quot;near-domain&quot;</span><span class="p">,</span> <span class="s2">&quot;out-domain&quot;</span><span class="p">,</span> <span class="s2">&quot;entire&quot;</span><span class="p">},</span>
    <span class="s2">&quot;SPICE&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;in-domain&quot;</span><span class="p">,</span> <span class="s2">&quot;near-domain&quot;</span><span class="p">,</span> <span class="s2">&quot;out-domain&quot;</span><span class="p">,</span> <span class="s2">&quot;entire&quot;</span><span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">updown</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="config.html">updown.config</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">updown.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">updown.models</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">updown.modules</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="utils.html">updown.utils</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="utils.cbs.html">updown.utils.cbs</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.checkpointing.html">updown.utils.checkpointing</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.common.html">updown.utils.common</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">updown.utils.evalai</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="utils.html">updown.utils</a><ul>
      <li>Previous: <a href="utils.common.html" title="previous chapter">updown.utils.common</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, nocaps team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/updown/utils.evalai.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>